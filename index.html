<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gateway.Bookmarks</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
<link rel="stylesheet" href="./css/larkRoot.css">
<link rel="stylesheet" href="./css/contextMenu.css">



</head>
<body>
    <style>
        .flexBox_h{
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            justify-content:flex-start;
        }

        .leftPanel{
            width:20% ;
            height:100vh ;
            overflow-x: hidden;
            overflow-y: hidden;

            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        .rightPanel{
            width:80% ;
            height:100% ;
            overflow-x: hidden;
            overflow-y: auto;

            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items:flex-start;
        }
    </style>
    <div class="larkRoot flexBox_h">
        <div class="leftPanel">
            <style>
                /*
                .headerToolBar{
                    width:100% ;
                    height:20px ;
                    flex-grow: 0 ;
                    background-color:blue;
                }
                */
                .headerToolBar{
                    width:100% ;
                    height:1.5rem ;
                    flex-grow: 0 ;
                    background-color:chocolate;
                }
                .folderBrowser{
                    width:100% ;
                    flex-grow: 1;
                    background-color: darkgrey;
                    overflow-x: hidden;
                    overflow-y: auto;
                    display: flex;
                    flex-direction: column;
                    justify-content: space-between;
                    align-items: center;
                }
                .bottomToolBar{
                    width:100% ;
                    height:1.5rem ;
                    flex-grow: 0 ;
                    background-color: brown;
                }
            </style>
            <div class="headerToolBar"></div>
            <div class="folderBrowser">
                <style>
                    .mustHave{
                        background-color:aqua;
                        width:100% ;
                        height:200px;
                        flex-grow: 0;
                        overflow-y: auto;
                        overflow-x: hidden;
                    }
                    .Folders{
                        background-color:cadetblue;
                        width:100% ;
                        flex-grow: 1;
                        overflow-y: auto;
                        overflow-x: hidden;
                    }

                    .bookmark:hover{
                        cursor:pointer ;
                    }

                    .folder:hover{
                        cursor:pointer ;
                    }

                    details > summary {
                        list-style: none;
                    }
                    details > summary::-webkit-details-marker {
                        display: none;
                    }

                    details ul{
                        padding-left: 5px;
                    }
                </style>
                <div class="mustHave"></div>
                <div class="Folders"></div>
            </div>
            <div class="bottomToolBar"></div>
        </div>
        <div class="rightPanel">
            <style>
                
                .mainCanvas{
                    width:100% ;
                    flex-grow: 1 ;
                    background-color:bisque;
                }
            </style>
            <div class="headerToolBar">right panel toolbar</div>
            <div class="mainCanvas">main canvas</div>
        </div>
    </div>
    <div class="container">
        <h1 style="text-align: center;padding: 12px;">自定义右键菜单，请右键查看菜单效果</h1>
         <!-- 填充内容 -->
    </div>
    <script src="./js/larkContextMenu.js"></script>
    <script src="./js/ContextMenuData.js"></script>
    <script src="./js/jsonGateway.js"></script>
    <script>
        const contextMenus = new ContextMenus({
            className: '.container', 
            menu:jsonMenu
        }) ;
        console.log(contextMenus);
        contextMenus.on((item, evt) => {
            console.log(item, evt);
        }) ;
    </script>

    <script>

        function gwRenderBookmark(jsonBookmark,tagParent){
            let tagBookMark = document.createElement('li') ;
            tagBookMark.innerHTML=`
                <i class="bi-journal-bookmark-fill"></i>
                ${jsonBookmark.title}
            ` ;
            tagParent.appendChild(tagBookMark) ;
            tagBookMark.classList.add('bookmark') ;
            //bookmark
            tagBookMark.dataset.url = jsonBookmark.url ;
            tagBookMark.addEventListener('click',(event)=>{
                let url = event.target.closest('li').dataset.url ;
                window.open(url, '_blank').focus();
            }) ;
        }

        function gwRenderFolder(jsonFolder,tagParent){
            let tagBookFolder = document.createElement('details') ;
            tagBookFolder.innerHTML=`
                    <style>
                        .folderSummary{
                            display: flex;
                            flex-direction: row;
                            justify-content: space-between;
                        }
                        .folderSummary:hover{
                            background-color:bisque;
                        }

                        .folderSummary #idBTNMore{
                            visibility: hidden;
                        }
                        .folderSummary:hover #idBTNMore{
                            visibility: visible;
                        }

                        .folderSummary #idFolderCounter{
                            visibility: visible;
                            font-size:0.65em ;
                        }
                        .folderSummary:hover #idFolderCounter{
                            visibility: hidden;
                        }

                    </style>
                    <summary class="folderSummary">
                        <span>
                            <i class="bi-folder2-open"></i>
                            ${jsonFolder.title}
                        </span>
                        <div>
                            <span id="idFolderCounter">32</span>
                            <i class="bi-three-dots" id="idBTNMore"></i>   
                        </div>                
                    </summary>
                    <ul></ul>
            ` ;
            tagParent.appendChild(tagBookFolder) ;
            tagBookFolder.classList.add('folder') ;

            tagBookFolder.querySelector('#idBTNMore').addEventListener('click',(event)=>{
                event.preventDefault() ;
                alert('TBD') ;
            }) ;

            for(let i=0;i<jsonFolder.Contents.length;i++){
                if(jsonFolder.Contents[i].type == 'Gateway.Folder'){
                    gwRenderFolder(jsonFolder.Contents[i],tagBookFolder.querySelector('ul')) ;
                }else{
                    gwRenderBookmark(jsonFolder.Contents[i],tagBookFolder.querySelector('ul'))
                }
            }
        }

        function gwRenderDesktop(jsonGateway,cssRootElement){
            let tagRoot=document.querySelector(cssRootElement) ;
            let tagMustHave = tagRoot.querySelector('.mustHave') ;
            let tagFolders = tagRoot.querySelector('.Folders') ;

            tagMustHave.innerHTML = `
                <ul></ul>
            ` ;

            let tagMustHaveUL = tagMustHave.querySelector('ul') ;
            for(let i=0;i<jsonGateway.data.mustHave.length;i++){
                gwRenderBookmark(jsonGateway.data.mustHave[i],tagMustHaveUL) ;
            }

            tagFolders.innerHTML = `
                <ul></ul>
            ` ;
            let tagFoldersUL = tagFolders.querySelector('ul') ;
            for(i=0;i<jsonGateway.data.Folders.length;i++){
                if(jsonGateway.data.Folders[i].type == "Gateway.Folder"){
                    gwRenderFolder(jsonGateway.data.Folders[i],tagFoldersUL) ;
                }else{
                    gwRenderBookmark(jsonGateway.data.Folders[i],tagFoldersUL) ;
                }
            }
        }

        gwRenderDesktop(jsonGateway,'.folderBrowser') ;
    </script>
</body>
</html>